package d;

import org.testng.annotations.Test;

import poi.Fileinput;

import org.testng.annotations.DataProvider;
import org.testng.annotations.BeforeTest;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.testng.annotations.AfterTest;

public class Login_dataproviderwithexcel 
{
	WebDriver driver;
  @Test(dataProvider = "dp")
  public void f(Integer n, String s) 
  {
	  PageLibrary_Signin_autoprac signin= new PageLibrary_Signin_autoprac(driver);
	  signin.signinlink();
	  signin.enteremail(emailadd);
	  signin.enterpassword(pass);
	  signin.clicksubmit();
	  signin.clicklogout();
  }

  @DataProvider
  public Object[][] dp() {
    
	  Fileinput file= new Fileinput("E:\\automation\\new.xlsx");

		int rowcount=file.Countrows(0);
		rowcount=rowcount+1;
		System.out.println("rows= "+rowcount);
		int columncount=file.Countcolumn(0);
		System.out.println("columns= "+columncount);
		
		Object data[][]=new Object[rowcount][columncount];
		for(int i=0;i<rowcount;i++)                                  
		{
			for(int j=0;j<columncount;j++)
			{
				data[i][j]=file.getdata(0, i, j);
			}
		}
		
		return data;
  }
  @BeforeTest
  public void beforeTest() throws InterruptedException 
  {		
	  System.setProperty("webdriver.chrome.driver","E:\\automation\\chromedriver\\chromedriver.exe");
		WebDriver driver= new ChromeDriver();
	  driver.get("http://automationpractice.com/index.php");

  }

  @AfterTest
  public void afterTest() 
  {
	  driver.close();
  }

}
